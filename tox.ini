[tox]
env_list =
    py38
    py39
    py310
    py311
    type
    lint
    counter-css
minversion = 4.11.4

[testenv]
description = test with pytest
package = wheel
wheel_build_env = .pkg
deps =
    pytest>=6
    pytest-cov
    PyHamcrest
    selenium
commands =
    pytest --cov --cov-config=tox.ini --cov-report html {tty:--color=yes} {posargs}

[testenv:clean]
deps = coverage
skip_install = true
commands = coverage erase

[coverage:run]
# Our test fixtures include autogenerated .py scripts; exclude these from test coverage.
omit =
    /tmp/*

[testenv:type]
description = type checking with mypy
deps =
    mypy>=1.8
    types-lxml
    types-Markdown
    types-Pillow
    types-Pygments
    matplotlib
; commands = mypy lamarkdown
commands = mypy --check-untyped-defs lamarkdown

[testenv:lint]
description = linting with flake8
deps =
    flake8
commands =
    flake8 lamarkdown tests --max-line-length=100 --ignore=E201,E221,E241,E251,E272,E303,W503

[testenv:counter-css]
description = converts the collection of standard CSS counter styles into Python code
commands = python util/css_counter_convert.py util/counter_styles.css
